-- Atividades 18/04/18
-- Aluno: Eric Maycon da Conceição Pessoa

-- Questão 01:

select count(*) from EMPLOYEES;

-- Questão 02:

select E.FIRST_NAME, E.LAST_NAME, E.EMPLOYEE_ID, D.DEPARTMENT_NAME
from EMPLOYEES E LEFT OUTER JOIN DEPARTMENTS D
on(E.DEPARTMENT_ID = D.DEPARTMENT_ID)
order by D.DEPARTMENT_NAME desc;

-- Questão 03:

select D.DEPARTMENT_NAME, E.EMPLOYEE_ID, E.FIRST_NAME, E.LAST_NAME, J.JOB_TITLE, 
EP.MANAGER_ID, EP.FIRST_NAME, EP.LAST_NAME
from EMPLOYEES E LEFT OUTER JOIN DEPARTMENTS D
on (E.DEPARTMENT_ID = D.DEPARTMENT_ID) LEFT OUTER JOIN JOBS J
on (E.JOB_ID = J.JOB_ID) LEFT OUTER JOIN EMPLOYEES EP
on (J.JOB_ID = EP.JOB_ID) and EP.MANAGER_ID = E.MANAGER_ID
and J.JOB_TITLE like '%Manager%'
order by EP.FIRST_NAME;

-- Questão 04:

select D.DEPARTMENT_NAME, E.FIRST_NAME, E.LAST_NAME
from DEPARTMENTS D INNER JOIN EMPLOYEES E
on (D.DEPARTMENT_ID = E.DEPARTMENT_ID)
order by (D.DEPARTMENT_NAME);

-- Questão 05:

select E.FIRST_NAME, E.LAST_NAME, E.SALARY, J.MIN_SALARY
from EMPLOYEES E INNER JOIN JOBS J
on (E.JOB_ID = J.JOB_ID)
order by J.MIN_SALARY;

-- Questão 06:

select E.FIRST_NAME, E.LAST_NAME
from EMPLOYEES E
where E.HIRE_DATE = (select min(E.HIRE_DATE) from EMPLOYEES E);

-- Questão 07:

select E.FIRST_NAME, E.LAST_NAME
from EMPLOYEES E LEFT OUTER JOIN JOB_HISTORY JH
on (E.EMPLOYEE_ID = JH.EMPLOYEE_ID)
group by E.FIRST_NAME, E.LAST_NAME
having count (JH.EMPLOYEE_ID) = 2;

-- Questão 08:

select E.MANAGER_ID, E.FIRST_NAME, E.LAST_NAME
from EMPLOYEES E
where E.MANAGER_ID = (select E.MANAGER_ID from EMPLOYEES E
group by E.MANAGER_ID
having count(E.MANAGER_ID) >= 6)
order by E.MANAGER_ID;

-- Questão 09:

select E.MANAGER_ID, E.FIRST_NAME, E.LAST_NAME, E.HIRE_DATE
from EMPLOYEES E
where E.MANAGER_ID = (select max(E.MANAGER_ID)from EMPLOYEES E
group by E.FIRST_NAME, E.LAST_NAME
having count (E.MANAGER_ID) >= 6)
order by E.MANAGER_ID;

-- Questão 10:

update EMPLOYEES set  SALARY = SALARY + (SALARY * 0,02);
select min(E.HIRE_DATE), E.MANAGER_ID
from EMPLOYEES E
group by E.HIRE_DATE
having count (E.MANAGER_ID) >= 6);



